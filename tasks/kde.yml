---
- name: Remove KDE packages I don't need
  become: true
  dnf:
    state: absent
    name: [
        'kgpg', 'falkon', 'kmahjongg', 'kpat', 'konqueror', 'dragon', 'k3b',
        'calligra-core', 'kontact', 'kmail', 'dnfdragora', 'kget', 'ktorrent',
        'kmines', 'kolourpaint', 'kruler', 'kamoso', 'juk', 'kwrite', 'kfind',
        'krusader', 'kmouth', 'kmousetool', 'kmag', 'akonadi-import-wizard',
        'korganizer', 'kaddressbook', 'kmail-account-wizard',
        'pim-data-exporter', 'pim-sieve-editor', 'kcolorchooser',
        'grantlee-editor', 'im-chooser', 'ibus-setup', 'ibus-cangjie',
        'qt5-qdbusviewer', 'gnome-disk-utility', 'kcharselect'
    ]

- name: Install KDE packages
  become: true
  dnf:
    state: present
    name: [
        'breeze-gtk',
        'kate',
        'filelight',
        'plasma-workspace-wayland',
        'plymouth-theme-breeze',
        'grub2-breeze-theme',
        'latte-dock',
        'ark',
        'okular',

        # for the 'ini_file' module to get it work on systems with selinux
        # Fedora in particular
        'python2-libselinux',
    ]

- name: Install packages for KDE development # FIXME
  become: true
  dnf:
    state: present
    name: [
        'perl-IPC-Cmd',
        'perl-JSON-PP',
        'perl-YAML-Syck',
        'dialog'
    ]

- name: Configure KDE
  ini_file:
    option: "{{ item.option }}"
    path: ~/.config/touchpadrc
    section: "{{ item.section }}"
    state: present
    value: "{{ item.value }}"
  loop:
    - { section: "autodisable",
        option:  "DisableWhenMousePluggedIn",
        value:   "true"}
